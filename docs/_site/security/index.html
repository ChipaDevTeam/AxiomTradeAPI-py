<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Best Practices - AxiomTradeAPI</title>
    <meta name="description" content="Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Professional security practices and threat mitigation strategies.">
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="solana trading bot, python trading api, cryptocurrency automation, solana api, trading bot development, chipa.tech">
    <meta name="author" content="Chipa Tech">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Security Best Practices - AxiomTradeAPI">
    <meta property="og:description" content="Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Professional security practices and threat mitigation strategies.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://chipadevteam.github.io/AxiomTradeAPI-py/security/">
    <meta property="og:site_name" content="AxiomTradeAPI Documentation">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Security Best Practices - AxiomTradeAPI">
    <meta name="twitter:description" content="Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Professional security practices and threat mitigation strategies.">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://chipadevteam.github.io/AxiomTradeAPI-py/security/">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/AxiomTradeAPI-py/assets/css/custom.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="axiom-docs">
    <!-- Header -->
    <!-- AxiomTradeAPI Documentation Header Component -->
<header class="site-header">
  <div class="container">
    <div class="header-content">
      <div class="logo-section">
        <a href="/AxiomTradeAPI-py/" class="logo-link">
          <h1 class="site-title">
            <i class="fas fa-robot"></i>
            AxiomTradeAPI
          </h1>
        </a>
        <p class="site-tagline">Professional Solana Trading Bot Library</p>
      </div>
      
      <nav class="main-nav" role="navigation" aria-label="Main navigation">
        <ul class="nav-list">
          <li><a href="/AxiomTradeAPI-py/" class="nav-link ">Home</a></li>
          <li><a href="/AxiomTradeAPI-py/installation" class="nav-link ">Quick Start</a></li>
          <li><a href="/AxiomTradeAPI-py/trading-bots" class="nav-link ">Trading Bots</a></li>
          <li><a href="/AxiomTradeAPI-py/websocket-guide" class="nav-link ">WebSocket</a></li>
          <li><a href="/AxiomTradeAPI-py/api-reference" class="nav-link ">API</a></li>
          <li>
            <a href="https://chipa.tech" class="nav-link external" target="_blank" rel="noopener">
              chipa.tech <i class="fas fa-external-link-alt"></i>
            </a>
          </li>
        </ul>
        
        <!-- Mobile menu toggle -->
        <button class="mobile-menu-toggle" aria-expanded="false" aria-controls="mobile-menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </nav>
      
      <!-- Search toggle -->
      <button class="search-toggle" onclick="toggleSearch()" aria-label="Open search">
        <i class="fas fa-search"></i>
      </button>
      
      <!-- Theme toggle -->
      <button class="theme-toggle-header" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
      </button>
    </div>
    
    <!-- Mobile menu -->
    <div class="mobile-menu" id="mobile-menu">
      <nav class="mobile-nav" role="navigation" aria-label="Mobile navigation">
        <a href="/AxiomTradeAPI-py/" class="mobile-nav-link">Home</a>
        <a href="/AxiomTradeAPI-py/installation" class="mobile-nav-link">Quick Start</a>
        <a href="/AxiomTradeAPI-py/trading-bots" class="mobile-nav-link">Trading Bots</a>
        <a href="/AxiomTradeAPI-py/websocket-guide" class="mobile-nav-link">WebSocket</a>
        <a href="/AxiomTradeAPI-py/api-reference" class="mobile-nav-link">API Reference</a>
        <a href="https://chipa.tech" class="mobile-nav-link external" target="_blank">chipa.tech</a>
      </nav>
    </div>
  </div>
</header>

<!-- Search overlay -->
<div class="search-overlay" id="search-overlay">
  <div class="search-container">
    <div class="search-header">
      <h3>Search Documentation</h3>
      <button class="search-close" onclick="toggleSearch()" aria-label="Close search">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <input type="text" class="search-input" id="global-search" placeholder="Search for guides, API methods, examples...">
    <div class="search-results" id="global-search-results"></div>
    <div class="search-shortcuts">
      <div class="shortcut-section">
        <h4>Quick Links</h4>
        <a href="/AxiomTradeAPI-py/installation" class="search-shortcut">
          <i class="fas fa-download"></i>
          Installation
        </a>
        <a href="/AxiomTradeAPI-py/trading-bots" class="search-shortcut">
          <i class="fas fa-robot"></i>
          Trading Bots
        </a>
        <a href="/AxiomTradeAPI-py/websocket-guide" class="search-shortcut">
          <i class="fas fa-stream"></i>
          WebSocket
        </a>
      </div>
    </div>
  </div>
</div>

<style>
/* Header styles */
.site-header {
  background: var(--bg-primary);
  border-bottom: 1px solid var(--border-light);
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow-sm);
}

.header-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 0;
}

.logo-link {
  text-decoration: none;
  color: inherit;
}

.site-title {
  font-size: 1.5rem;
  margin: 0;
  color: var(--primary-color);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.site-tagline {
  font-size: 0.875rem;
  color: var(--text-muted);
  margin: 0;
}

.nav-list {
  display: flex;
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 2rem;
}

.nav-link {
  color: var(--text-secondary);
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition-fast);
  padding: 0.5rem 0;
  position: relative;
}

.nav-link:hover,
.nav-link.active {
  color: var(--primary-color);
}

.nav-link.active::after {
  content: '';
  position: absolute;
  bottom: -1rem;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--primary-color);
}

.nav-link.external {
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

.search-toggle,
.theme-toggle-header {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 6px;
  transition: var(--transition-fast);
}

.search-toggle:hover,
.theme-toggle-header:hover {
  background: var(--bg-secondary);
  color: var(--primary-color);
}

.mobile-menu-toggle {
  display: none;
  flex-direction: column;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  gap: 3px;
}

.hamburger-line {
  width: 20px;
  height: 2px;
  background: var(--text-primary);
  transition: var(--transition-fast);
}

.mobile-menu {
  display: none;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-light);
  padding: 1rem 0;
}

.mobile-nav {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.mobile-nav-link {
  color: var(--text-secondary);
  text-decoration: none;
  padding: 0.75rem 1rem;
  border-radius: 6px;
  transition: var(--transition-fast);
}

.mobile-nav-link:hover {
  background: var(--bg-primary);
  color: var(--primary-color);
}

/* Search overlay styles */
.search-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  z-index: 1000;
  display: none;
  opacity: 0;
  transition: opacity var(--transition-normal);
}

.search-overlay.active {
  display: flex;
  opacity: 1;
  justify-content: center;
  align-items: flex-start;
  padding-top: 5vh;
}

.search-container {
  background: var(--bg-primary);
  border-radius: 12px;
  padding: 2rem;
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: var(--shadow-xl);
}

.search-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
}

.search-header h3 {
  margin: 0;
  color: var(--text-primary);
}

.search-close {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 6px;
  transition: var(--transition-fast);
}

.search-close:hover {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

.search-shortcuts {
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 1px solid var(--border-light);
}

.shortcut-section h4 {
  margin-bottom: 1rem;
  color: var(--text-primary);
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.search-shortcut {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem;
  color: var(--text-secondary);
  text-decoration: none;
  border-radius: 6px;
  transition: var(--transition-fast);
  margin-bottom: 0.5rem;
}

.search-shortcut:hover {
  background: var(--bg-secondary);
  color: var(--primary-color);
}

.search-shortcut i {
  color: var(--primary-color);
  width: 16px;
}

/* Mobile responsive */
@media (max-width: 768px) {
  .main-nav .nav-list {
    display: none;
  }
  
  .mobile-menu-toggle {
    display: flex;
  }
  
  .mobile-menu.active {
    display: block;
  }
  
  .mobile-menu-toggle[aria-expanded="true"] .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }
  
  .mobile-menu-toggle[aria-expanded="true"] .hamburger-line:nth-child(2) {
    opacity: 0;
  }
  
  .mobile-menu-toggle[aria-expanded="true"] .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -6px);
  }
  
  .header-content {
    flex-wrap: wrap;
  }
  
  .search-container {
    width: 95%;
    padding: 1.5rem;
  }
}
</style>

<script>
function toggleSearch() {
  const overlay = document.getElementById('search-overlay');
  const searchInput = document.getElementById('global-search');
  
  if (overlay.classList.contains('active')) {
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  } else {
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
    setTimeout(() => searchInput.focus(), 100);
  }
}

function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  
  // Update theme toggle icons
  const headerToggle = document.querySelector('.theme-toggle-header i');
  const footerToggle = document.querySelector('.theme-toggle i');
  
  const newIcon = newTheme === 'dark' ? 'fa-sun' : 'fa-moon';
  
  if (headerToggle) headerToggle.className = `fas ${newIcon}`;
  if (footerToggle) footerToggle.className = `fas ${newIcon}`;
}

// Close search with Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const overlay = document.getElementById('search-overlay');
    if (overlay.classList.contains('active')) {
      toggleSearch();
    }
  }
});

// Close search when clicking outside
document.getElementById('search-overlay').addEventListener('click', function(e) {
  if (e.target === this) {
    toggleSearch();
  }
});
</script>


    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="page-wrapper">
  <!-- Breadcrumb Navigation -->
  <nav class="breadcrumb-nav">
    <div class="container">
      <ol class="breadcrumb">
        <li><a href="/AxiomTradeAPI-py/">Home</a></li>
        
        <li class="active">Security Best Practices - AxiomTradeAPI</li>
      </ol>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="page-content">
    <div class="container">
      <div class="content-grid">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
          <div class="sidebar-content">
            <div class="sidebar-section">
              <h3>Getting Started</h3>
              <ul class="sidebar-nav">
                <li><a href="/AxiomTradeAPI-py/installation">Installation</a></li>
                <li><a href="/AxiomTradeAPI-py/authentication">Authentication</a></li>
                <li><a href="/AxiomTradeAPI-py/quickstart">Quick Start</a></li>
              </ul>
            </div>

            <div class="sidebar-section">
              <h3>Core Features</h3>
              <ul class="sidebar-nav">
                <li><a href="/AxiomTradeAPI-py/balance-queries">Balance Queries</a></li>
                <li><a href="/AxiomTradeAPI-py/websocket-guide">WebSocket Streaming</a></li>
                <li><a href="/AxiomTradeAPI-py/error-handling">Error Handling</a></li>
              </ul>
            </div>

            <div class="sidebar-section">
              <h3>Advanced Trading</h3>
              <ul class="sidebar-nav">
                <li><a href="/AxiomTradeAPI-py/trading-bots">Trading Bots</a></li>
                <li><a href="/AxiomTradeAPI-py/market-making">Market Making</a></li>
                <li><a href="/AxiomTradeAPI-py/risk-management">Risk Management</a></li>
              </ul>
            </div>

            <div class="sidebar-section">
              <h3>Resources</h3>
              <ul class="sidebar-nav">
                <li><a href="/AxiomTradeAPI-py/api-reference">API Reference</a></li>
                <li><a href="/AxiomTradeAPI-py/examples">Examples</a></li>
                <li><a href="https://chipa.tech" target="_blank">chipa.tech Services</a></li>
              </ul>
            </div>

            <!-- Promotional Section -->
            <div class="sidebar-promo">
              <div class="promo-card">
                <h4>Need Custom Development?</h4>
                <p>Get professional trading bot development services from the chipa.tech team.</p>
                <a href="https://chipa.tech/product/create-your-bot" class="btn btn-primary btn-sm" target="_blank">
                  Get Started
                </a>
              </div>
            </div>
          </div>
        </aside>

        <!-- Article Content -->
        <article class="main-content">
          <header class="article-header">
            <h1 class="article-title">Security Best Practices - AxiomTradeAPI</h1>
            
            <p class="article-description">Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Professional security practices and threat mitigation strategies.</p>
            
            
            
          </header>

          <div class="article-content">
            <div class="guide-wrapper">
  <!-- Guide Header -->
  <div class="guide-header">
    
    <div class="difficulty-badge intermediate">
      
    </div>
    
    
    <h1 class="guide-title">Security Best Practices - AxiomTradeAPI</h1>
    
    
    <p class="guide-description">Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Professional security practices and threat mitigation strategies.</p>
    
    
    
  </div>

  <!-- Prerequisites -->
  

  <!-- Table of Contents -->
  
  <div class="table-of-contents">
    <h3>Table of Contents</h3>
    <div id="toc-content">
      <!-- Will be populated by JavaScript -->
    </div>
  </div>
  

  <!-- Guide Content -->
  <div class="guide-content">
    <h1 id="security-best-practices-for-axiomtradeapi">Security Best Practices for AxiomTradeAPI</h1>

<p><em>Comprehensive security guide for safely using AxiomTradeAPI in production trading environments. Learn professional security practices and threat mitigation strategies trusted by leading traders on chipa.tech.</em></p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#overview">Security Overview</a></li>
  <li><a href="#api-keys">API Key Management</a></li>
  <li><a href="#network">Network Security</a></li>
  <li><a href="#data-protection">Data Protection</a></li>
  <li><a href="#access-control">Access Control</a></li>
  <li><a href="#monitoring">Monitoring and Auditing</a></li>
  <li><a href="#incident-response">Incident Response</a></li>
  <li><a href="#compliance">Compliance and Regulations</a></li>
</ul>

<h2 id="overview">Security Overview</h2>

<p>Security is paramount in trading applications where financial assets are at risk. The AxiomTradeAPI implements multiple layers of security, and this guide helps you maintain security best practices in your implementation.</p>

<h3 id="security-architecture">Security Architecture</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">secrets</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">jwt</span>
<span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.kdf.pbkdf2</span> <span class="kn">import</span> <span class="n">PBKDF2HMAC</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="k">class</span> <span class="nc">SecurityLevel</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""Security level classification"""</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s">"low"</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s">"medium"</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s">"high"</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s">"critical"</span>

<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">SecurityContext</span><span class="p">:</span>
    <span class="s">"""Security context for API operations"""</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">user_agent</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">security_level</span><span class="p">:</span> <span class="n">SecurityLevel</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">is_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if security context has expired"""</span>
        <span class="k">return</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&gt;</span> <span class="n">timeout_seconds</span>
    
    <span class="k">def</span> <span class="nf">has_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">required_permission</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if context has required permission"""</span>
        <span class="k">return</span> <span class="n">required_permission</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">permissions</span>

<span class="k">class</span> <span class="nc">SecureAxiomClient</span><span class="p">:</span>
    <span class="s">"""
    Security-hardened AxiomTradeAPI client
    Production security practices from chipa.tech security team
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">encryption_key</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_derive_encryption_key</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">security_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SecurityContext</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rate_limiter</span> <span class="o">=</span> <span class="n">APIRateLimiter</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">audit_logger</span> <span class="o">=</span> <span class="n">SecurityAuditLogger</span><span class="p">()</span>
        
        <span class="c1"># Security validation
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">_validate_security_config</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_validate_security_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Validate security configuration"""</span>
        <span class="n">required_settings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">'api_token_encrypted'</span><span class="p">,</span>
            <span class="s">'encryption_password'</span><span class="p">,</span>
            <span class="s">'allowed_ips'</span><span class="p">,</span>
            <span class="s">'max_request_rate'</span><span class="p">,</span>
            <span class="s">'session_timeout'</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">required_settings</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">setting</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">config</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Missing required security setting: </span><span class="si">{</span><span class="n">setting</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Validate token encryption
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_is_token_encrypted</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"API token must be encrypted in configuration"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_derive_encryption_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fernet</span><span class="p">:</span>
        <span class="s">"""Derive encryption key from password"""</span>
        <span class="n">password</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="s">'encryption_password'</span><span class="p">].</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">salt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'encryption_salt'</span><span class="p">,</span> <span class="sa">b</span><span class="s">'stable_salt'</span><span class="p">).</span><span class="n">encode</span><span class="p">()</span>
        
        <span class="n">kdf</span> <span class="o">=</span> <span class="n">PBKDF2HMAC</span><span class="p">(</span>
            <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span>
            <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span>
            <span class="n">iterations</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">kdf</span><span class="p">.</span><span class="n">derive</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_is_token_encrypted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if API token is encrypted"""</span>
        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'api_token_encrypted'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">encryption_key</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">get_decrypted_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Safely decrypt API token"""</span>
        <span class="n">encrypted_token</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="s">'api_token_encrypted'</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">decrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">encryption_key</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_token</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">decrypted</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed to decrypt API token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">encrypt_sensitive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Encrypt sensitive data"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">encryption_key</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="n">decode</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">decrypt_sensitive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encrypted_data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Decrypt sensitive data"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">encryption_key</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="n">decode</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">SecurityError</span><span class="p">(</span><span class="nb">Exception</span><span class="p">):</span>
    <span class="s">"""Security-related exceptions"""</span>
    <span class="k">pass</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="api-keys">API Key Management</h2>

<p>Proper API key management is critical for maintaining security:</p>

<h3 id="secure-token-storage">Secure Token Storage</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">keyring</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">SecureTokenManager</span><span class="p">:</span>
    <span class="s">"""
    Secure API token management system
    Enterprise token security from chipa.tech security infrastructure
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"AxiomTradeAPI"</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">service_name</span> <span class="o">=</span> <span class="n">service_name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s">'.axiomtradeapi'</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o700</span><span class="p">)</span>  <span class="c1"># Owner read/write only
</span>        
    <span class="k">def</span> <span class="nf">store_token_securely</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"default"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Store API token securely using system keyring"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Validate token format
</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_validate_token_format</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"Invalid token format"</span><span class="p">)</span>
            
            <span class="c1"># Store in system keyring
</span>            <span class="n">keyring</span><span class="p">.</span><span class="n">set_password</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">service_name</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
            
            <span class="c1"># Store metadata (non-sensitive)
</span>            <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">'username'</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
                <span class="s">'created_at'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">(),</span>
                <span class="s">'last_used'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                <span class="s">'usage_count'</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">}</span>
            
            <span class="n">metadata_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">_metadata.json"</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="c1"># Set secure file permissions
</span>            <span class="n">metadata_path</span><span class="p">.</span><span class="n">chmod</span><span class="p">(</span><span class="mo">0o600</span><span class="p">)</span>
            
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"✅ Token stored securely for user: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to store token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">retrieve_token_securely</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"default"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="s">"""Retrieve API token securely from system keyring"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">keyring</span><span class="p">.</span><span class="n">get_password</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">service_name</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                <span class="c1"># Update usage metadata
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">_update_token_usage</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
                
                <span class="c1"># Validate token before returning
</span>                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">_validate_token_format</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">token</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"⚠️ Retrieved token appears invalid"</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">None</span>
            
            <span class="k">return</span> <span class="bp">None</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to retrieve token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">delete_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"default"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Securely delete stored token"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">keyring</span><span class="p">.</span><span class="n">delete_password</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">service_name</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
            
            <span class="c1"># Remove metadata file
</span>            <span class="n">metadata_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">_metadata.json"</span>
            <span class="k">if</span> <span class="n">metadata_path</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">metadata_path</span><span class="p">.</span><span class="n">unlink</span><span class="p">()</span>
            
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"✅ Token deleted for user: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to delete token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">rotate_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Rotate API token securely"""</span>
        <span class="n">new_username</span> <span class="o">=</span> <span class="n">new_username</span> <span class="ow">or</span> <span class="n">old_username</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Store new token
</span>            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">store_token_securely</span><span class="p">(</span><span class="n">new_token</span><span class="p">,</span> <span class="n">new_username</span><span class="p">):</span>
                <span class="c1"># Delete old token if username is different
</span>                <span class="k">if</span> <span class="n">new_username</span> <span class="o">!=</span> <span class="n">old_username</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">delete_token</span><span class="p">(</span><span class="n">old_username</span><span class="p">)</span>
                
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"✅ Token rotated successfully"</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">True</span>
            
            <span class="k">return</span> <span class="bp">False</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Token rotation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">_validate_token_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Validate API token format"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># Add specific validation for AxiomTradeAPI token format
</span>        <span class="c1"># This would depend on your actual token format
</span>        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">_update_token_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="s">"""Update token usage metadata"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">metadata_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">_metadata.json"</span>
            
            <span class="k">if</span> <span class="n">metadata_path</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                
                <span class="n">metadata</span><span class="p">[</span><span class="s">'last_used'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">metadata</span><span class="p">[</span><span class="s">'usage_count'</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'usage_count'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Don't fail token retrieval due to metadata issues
</span>            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"⚠️ Failed to update token metadata: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">list_stored_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="s">"""List all stored tokens (metadata only)"""</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">metadata_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">config_dir</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="s">"*_metadata.json"</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_file</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                
                <span class="c1"># Check if token still exists in keyring
</span>                <span class="n">username</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
                <span class="n">token_exists</span> <span class="o">=</span> <span class="n">keyring</span><span class="p">.</span><span class="n">get_password</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">service_name</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                
                <span class="n">metadata</span><span class="p">[</span><span class="s">'token_exists'</span><span class="p">]</span> <span class="o">=</span> <span class="n">token_exists</span>
                <span class="n">tokens</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"⚠️ Error reading metadata for </span><span class="si">{</span><span class="n">metadata_file</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">tokens</span>

<span class="c1"># Environment-based token management
</span><span class="k">class</span> <span class="nc">EnvironmentTokenManager</span><span class="p">:</span>
    <span class="s">"""Manage tokens through environment variables with security checks"""</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">get_token_from_env</span><span class="p">(</span><span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"AXIOM_API_TOKEN"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="s">"""Get token from environment variable with security validation"""</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="c1"># Validate environment security
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">EnvironmentTokenManager</span><span class="p">.</span><span class="n">_is_environment_secure</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"Environment is not secure for token storage"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">token</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_environment_secure</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if current environment is secure for token storage"""</span>
        <span class="c1"># Check if running in production environment
</span>        <span class="n">env</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">'ENVIRONMENT'</span><span class="p">,</span> <span class="s">'development'</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="c1"># Production environments should have additional security
</span>        <span class="k">if</span> <span class="n">env</span> <span class="o">==</span> <span class="s">'production'</span><span class="p">:</span>
            <span class="c1"># Check for required security environment variables
</span>            <span class="n">required_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s">'SECURITY_LEVEL'</span><span class="p">,</span> <span class="s">'ENCRYPTION_KEY'</span><span class="p">,</span> <span class="s">'ACCESS_LOG_ENABLED'</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">required_vars</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># Check file permissions (Unix-like systems)
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">stat</span>
            <span class="n">current_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
            <span class="n">file_stat</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">stat</span><span class="p">(</span><span class="n">current_file</span><span class="p">)</span>
            
            <span class="c1"># Check if file is world-readable
</span>            <span class="k">if</span> <span class="n">file_stat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">stat</span><span class="p">.</span><span class="n">S_IROTH</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
                
        <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># Skip permission check on Windows
</span>        
        <span class="k">return</span> <span class="bp">True</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="token-rotation-and-lifecycle-management">Token Rotation and Lifecycle Management</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">schedule</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span>

<span class="k">class</span> <span class="nc">TokenLifecycleManager</span><span class="p">:</span>
    <span class="s">"""
    Automated token lifecycle management
    Security automation from chipa.tech token management system
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_manager</span><span class="p">:</span> <span class="n">SecureTokenManager</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span> <span class="o">=</span> <span class="n">token_manager</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rotation_callbacks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">expiration_warning_days</span> <span class="o">=</span> <span class="mi">7</span>
        
    <span class="k">def</span> <span class="nf">setup_automatic_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_interval_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">):</span>
        <span class="s">"""Setup automatic token rotation"""</span>
        
        <span class="k">def</span> <span class="nf">rotate_tokens</span><span class="p">():</span>
            <span class="s">"""Automatic token rotation job"""</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"🔄 Starting automatic token rotation..."</span><span class="p">)</span>
                
                <span class="c1"># Get all stored tokens
</span>                <span class="n">tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span><span class="p">.</span><span class="n">list_stored_tokens</span><span class="p">()</span>
                
                <span class="k">for</span> <span class="n">token_info</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
                    <span class="n">username</span> <span class="o">=</span> <span class="n">token_info</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
                    <span class="n">created_at</span> <span class="o">=</span> <span class="n">token_info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'created_at'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    
                    <span class="c1"># Check if token needs rotation
</span>                    <span class="n">age_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">created_at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">age_days</span> <span class="o">&gt;=</span> <span class="n">rotation_interval_days</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🔄 Rotating token for user: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                        
                        <span class="c1"># Generate new token (this would call your API)
</span>                        <span class="n">new_token</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_generate_new_token</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
                        
                        <span class="k">if</span> <span class="n">new_token</span><span class="p">:</span>
                            <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span><span class="p">.</span><span class="n">rotate_token</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">new_token</span><span class="p">)</span>
                            
                            <span class="c1"># Notify callbacks
</span>                            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">rotation_callbacks</span><span class="p">:</span>
                                <span class="n">callback</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">new_token</span><span class="p">)</span>
                        
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Automatic token rotation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Schedule rotation
</span>        <span class="n">schedule</span><span class="p">.</span><span class="n">every</span><span class="p">(</span><span class="n">rotation_interval_days</span><span class="p">).</span><span class="n">days</span><span class="p">.</span><span class="n">do</span><span class="p">(</span><span class="n">rotate_tokens</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"⏰ Scheduled automatic token rotation every </span><span class="si">{</span><span class="n">rotation_interval_days</span><span class="si">}</span><span class="s"> days"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">check_token_expiration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="s">"""Check for tokens nearing expiration"""</span>
        <span class="n">expiring_tokens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span><span class="p">.</span><span class="n">list_stored_tokens</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">token_info</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">token_info</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
            <span class="n">created_at</span> <span class="o">=</span> <span class="n">token_info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'created_at'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
            <span class="c1"># Calculate days until expiration (assuming 90-day token lifetime)
</span>            <span class="n">age_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">created_at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span>
            <span class="n">days_until_expiration</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">age_days</span>
            
            <span class="k">if</span> <span class="n">days_until_expiration</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">expiration_warning_days</span><span class="p">:</span>
                <span class="n">expiring_tokens</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s">'username'</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
                    <span class="s">'days_until_expiration'</span><span class="p">:</span> <span class="n">days_until_expiration</span><span class="p">,</span>
                    <span class="s">'created_at'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">created_at</span><span class="p">).</span><span class="n">isoformat</span><span class="p">()</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">expiring_tokens</span>
    
    <span class="k">def</span> <span class="nf">add_rotation_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="bp">None</span><span class="p">]):</span>
        <span class="s">"""Add callback for token rotation events"""</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rotation_callbacks</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_generate_new_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="s">"""Generate new API token (placeholder - implement actual API call)"""</span>
        <span class="c1"># This would call your API to generate a new token
</span>        <span class="c1"># For security, this should require additional authentication
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"📡 Generating new token for </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>
        
        <span class="c1"># Placeholder implementation
</span>        <span class="k">return</span> <span class="sa">f</span><span class="s">"new_token_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">"</span>
    
    <span class="k">def</span> <span class="nf">run_scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Run the token lifecycle scheduler"""</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"🚀 Starting token lifecycle scheduler..."</span><span class="p">)</span>
        
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">schedule</span><span class="p">.</span><span class="n">run_pending</span><span class="p">()</span>
            <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># Check every hour
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="network">Network Security</h2>

<p>Implementing robust network security measures:</p>

<h3 id="request-signing-and-verification">Request Signing and Verification</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>

<span class="k">class</span> <span class="nc">RequestSigner</span><span class="p">:</span>
    <span class="s">"""
    Request signing for additional security
    Cryptographic security from chipa.tech authentication system
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">sign_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="s">"""Sign API request for additional security"""</span>
        
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span>
        
        <span class="c1"># Create signature payload
</span>        <span class="n">signature_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_create_signature_payload</span><span class="p">(</span>
            <span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">timestamp</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate signature
</span>        <span class="n">signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">secret_key</span><span class="p">,</span>
            <span class="n">signature_payload</span><span class="p">.</span><span class="n">encode</span><span class="p">(),</span>
            <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span>
        <span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'X-Axiom-Timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">),</span>
            <span class="s">'X-Axiom-Signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
            <span class="s">'X-Axiom-Version'</span><span class="p">:</span> <span class="s">'1.0'</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">verify_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received_signature</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                        <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Verify request signature"""</span>
        
        <span class="c1"># Check timestamp freshness (prevent replay attacks)
</span>        <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">-</span> <span class="n">timestamp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>  <span class="c1"># 5 minutes
</span>            <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># Calculate expected signature
</span>        <span class="n">expected_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">sign_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="n">expected_signature</span> <span class="o">=</span> <span class="n">expected_headers</span><span class="p">[</span><span class="s">'X-Axiom-Signature'</span><span class="p">]</span>
        
        <span class="c1"># Use constant-time comparison to prevent timing attacks
</span>        <span class="k">return</span> <span class="n">hmac</span><span class="p">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">expected_signature</span><span class="p">,</span> <span class="n">received_signature</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_create_signature_payload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                 <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                                 <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Create standardized signature payload"""</span>
        
        <span class="c1"># Normalize parameters
</span>        <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">sorted_params</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sorted_params</span> <span class="o">=</span> <span class="s">""</span>
        
        <span class="c1"># Create payload
</span>        <span class="n">payload_parts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">method</span><span class="p">.</span><span class="n">upper</span><span class="p">(),</span>
            <span class="n">endpoint</span><span class="p">,</span>
            <span class="n">sorted_params</span><span class="p">,</span>
            <span class="n">body</span> <span class="ow">or</span> <span class="s">""</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="p">]</span>
        
        <span class="k">return</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">payload_parts</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SecureHTTPClient</span><span class="p">:</span>
    <span class="s">"""HTTP client with enhanced security features"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">token_manager</span><span class="p">:</span> <span class="n">SecureTokenManager</span><span class="p">,</span>
                 <span class="n">request_signer</span><span class="p">:</span> <span class="n">RequestSigner</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span> <span class="o">=</span> <span class="n">token_manager</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request_signer</span> <span class="o">=</span> <span class="n">request_signer</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">session_manager</span> <span class="o">=</span> <span class="n">SessionManager</span><span class="p">()</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">make_secure_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                                <span class="n">json_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Make secure API request with full security features"""</span>
        
        <span class="c1"># Get secure token
</span>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span><span class="p">.</span><span class="n">retrieve_token_securely</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"No valid API token available"</span><span class="p">)</span>
        
        <span class="c1"># Prepare headers
</span>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'Authorization'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'Bearer </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s">'</span><span class="p">,</span>
            <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
            <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'AxiomTradeAPI-SecureClient/1.0'</span><span class="p">,</span>
            <span class="s">'X-Request-ID'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_generate_request_id</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="c1"># Add request signature if signer is available
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">request_signer</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span> <span class="k">if</span> <span class="n">json_data</span> <span class="k">else</span> <span class="bp">None</span>
            <span class="n">signature_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">request_signer</span><span class="p">.</span><span class="n">sign_request</span><span class="p">(</span>
                <span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">body</span>
            <span class="p">)</span>
            <span class="n">headers</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">signature_headers</span><span class="p">)</span>
        
        <span class="c1"># Add security headers
</span>        <span class="n">headers</span><span class="p">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'X-Content-Type-Options'</span><span class="p">:</span> <span class="s">'nosniff'</span><span class="p">,</span>
            <span class="s">'X-Frame-Options'</span><span class="p">:</span> <span class="s">'DENY'</span><span class="p">,</span>
            <span class="s">'X-XSS-Protection'</span><span class="p">:</span> <span class="s">'1; mode=block'</span>
        <span class="p">})</span>
        
        <span class="c1"># Log security event
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">_log_security_event</span><span class="p">(</span><span class="s">'api_request'</span><span class="p">,</span> <span class="p">{</span>
            <span class="s">'method'</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
            <span class="s">'endpoint'</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
            <span class="s">'request_id'</span><span class="p">:</span> <span class="n">headers</span><span class="p">[</span><span class="s">'X-Request-ID'</span><span class="p">]</span>
        <span class="p">})</span>
        
        <span class="c1"># Make request with timeout and retries
</span>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">_execute_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">json_data</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_generate_request_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Generate unique request ID"""</span>
        <span class="kn">import</span> <span class="nn">uuid</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">_log_security_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="s">"""Log security-related events"""</span>
        <span class="c1"># Implementation would integrate with your security logging system
</span>        <span class="k">pass</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_execute_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
                              <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Execute HTTP request with security controls"""</span>
        <span class="c1"># Implementation would use your preferred HTTP client (aiohttp, httpx, etc.)
</span>        <span class="c1"># with proper timeout, retry, and error handling
</span>        <span class="k">pass</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="data-protection">Data Protection</h2>

<p>Protecting sensitive data in transit and at rest:</p>

<h3 id="data-encryption-and-sanitization">Data Encryption and Sanitization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span><span class="p">,</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="k">class</span> <span class="nc">DataProtectionManager</span><span class="p">:</span>
    <span class="s">"""
    Comprehensive data protection system
    Data security practices from chipa.tech privacy engineering
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encryption_key</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">symmetric_cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">encryption_key</span> <span class="ow">or</span> <span class="n">Fernet</span><span class="p">.</span><span class="n">generate_key</span><span class="p">())</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">sensitive_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_compile_sensitive_patterns</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_compile_sensitive_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
        <span class="s">"""Compile regex patterns for sensitive data detection"""</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'\b[A-Za-z0-9]{43,44}\b'</span><span class="p">),</span> <span class="s">'SOLANA_ADDRESS'</span><span class="p">),</span>  <span class="c1"># Solana addresses
</span>            <span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'\b[A-Za-z0-9+/]{40,}\b'</span><span class="p">),</span> <span class="s">'API_TOKEN'</span><span class="p">),</span>        <span class="c1"># API tokens
</span>            <span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'\b\d{16,19}\b'</span><span class="p">),</span> <span class="s">'CARD_NUMBER'</span><span class="p">),</span>                <span class="c1"># Credit card numbers
</span>            <span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'</span><span class="p">),</span> <span class="s">'EMAIL'</span><span class="p">),</span>
            <span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'\b(?:\d{1,3}\.){3}\d{1,3}\b'</span><span class="p">),</span> <span class="s">'IP_ADDRESS'</span><span class="p">),</span>  <span class="c1"># IP addresses
</span>        <span class="p">]</span>
        <span class="k">return</span> <span class="n">patterns</span>
    
    <span class="k">def</span> <span class="nf">encrypt_sensitive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Encrypt sensitive data for storage"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">encrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">symmetric_cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">base64</span><span class="p">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">encrypted</span><span class="p">).</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Encryption failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">decrypt_sensitive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encrypted_data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Decrypt sensitive data"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">decoded</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="n">decrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">symmetric_cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">decrypted</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Decryption failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">sanitize_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Sanitize log messages to remove sensitive data"""</span>
        <span class="n">sanitized</span> <span class="o">=</span> <span class="n">log_message</span>
        
        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">sensitive_patterns</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">replace_match</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
                <span class="n">original</span> <span class="o">=</span> <span class="n">match</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>
                <span class="n">masked_length</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s">"[</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">original</span><span class="p">[</span><span class="si">:</span><span class="mi">2</span><span class="p">]</span><span class="si">}{</span><span class="s">'*'</span> <span class="o">*</span> <span class="p">(</span><span class="n">masked_length</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="si">}{</span><span class="n">original</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="si">:</span><span class="p">]</span><span class="si">}</span><span class="s">]"</span>
            
            <span class="n">sanitized</span> <span class="o">=</span> <span class="n">pattern</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">replace_match</span><span class="p">,</span> <span class="n">sanitized</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">sanitized</span>
    
    <span class="k">def</span> <span class="nf">detect_sensitive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="s">"""Detect sensitive data in text"""</span>
        <span class="n">detected</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">sensitive_patterns</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">pattern</span><span class="p">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">detected</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s">'type'</span><span class="p">:</span> <span class="n">data_type</span><span class="p">,</span>
                    <span class="s">'value'</span><span class="p">:</span> <span class="n">match</span><span class="p">.</span><span class="n">group</span><span class="p">(),</span>
                    <span class="s">'start'</span><span class="p">:</span> <span class="n">match</span><span class="p">.</span><span class="n">start</span><span class="p">(),</span>
                    <span class="s">'end'</span><span class="p">:</span> <span class="n">match</span><span class="p">.</span><span class="n">end</span><span class="p">()</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">detected</span>
    
    <span class="k">def</span> <span class="nf">secure_delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="s">"""Securely delete file (overwrite before deletion)"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="c1"># Get file size
</span>                <span class="n">file_size</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                
                <span class="c1"># Overwrite with random data multiple times
</span>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">'r+b'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  <span class="c1"># 3 passes
</span>                        <span class="nb">file</span><span class="p">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="n">file_size</span><span class="p">))</span>
                        <span class="nb">file</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
                        <span class="n">os</span><span class="p">.</span><span class="n">fsync</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">fileno</span><span class="p">())</span>
                
                <span class="c1"># Delete the file
</span>                <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🗑️ File securely deleted: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Secure deletion failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SecurePersistentStorage</span><span class="p">:</span>
    <span class="s">"""Secure storage for persistent data"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encryption_key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">storage_path</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o700</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">store_encrypted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Store data with encryption"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Serialize and encrypt data
</span>            <span class="n">serialized</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">encrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">serialized</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
            
            <span class="c1"># Store to file
</span>            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">storage_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">.enc"</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
            
            <span class="c1"># Set secure permissions
</span>            <span class="n">file_path</span><span class="p">.</span><span class="n">chmod</span><span class="p">(</span><span class="mo">0o600</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to store encrypted data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">retrieve_encrypted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Retrieve and decrypt data"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">storage_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">.enc"</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">None</span>
            
            <span class="c1"># Read and decrypt
</span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">encrypted</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
            
            <span class="n">decrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">decrypted</span><span class="p">.</span><span class="n">decode</span><span class="p">())</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to retrieve encrypted data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">delete_encrypted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Securely delete encrypted data"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">storage_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">.enc"</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="c1"># Secure deletion
</span>                <span class="n">DataProtectionManager</span><span class="p">().</span><span class="n">secure_delete_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="bp">False</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to delete encrypted data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="access-control">Access Control</h2>

<p>Implementing robust access control mechanisms:</p>

<h3 id="role-based-access-control-rbac">Role-Based Access Control (RBAC)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">class</span> <span class="nc">Permission</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""System permissions"""</span>
    <span class="n">READ_BALANCE</span> <span class="o">=</span> <span class="s">"read_balance"</span>
    <span class="n">READ_TRANSACTIONS</span> <span class="o">=</span> <span class="s">"read_transactions"</span>
    <span class="n">EXECUTE_TRADES</span> <span class="o">=</span> <span class="s">"execute_trades"</span>
    <span class="n">MANAGE_WEBHOOKS</span> <span class="o">=</span> <span class="s">"manage_webhooks"</span>
    <span class="n">ADMIN_ACCESS</span> <span class="o">=</span> <span class="s">"admin_access"</span>
    <span class="n">READ_MARKET_DATA</span> <span class="o">=</span> <span class="s">"read_market_data"</span>
    <span class="n">MANAGE_API_KEYS</span> <span class="o">=</span> <span class="s">"manage_api_keys"</span>

<span class="k">class</span> <span class="nc">Role</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""System roles"""</span>
    <span class="n">VIEWER</span> <span class="o">=</span> <span class="s">"viewer"</span>
    <span class="n">TRADER</span> <span class="o">=</span> <span class="s">"trader"</span>
    <span class="n">PREMIUM_TRADER</span> <span class="o">=</span> <span class="s">"premium_trader"</span>
    <span class="n">ADMIN</span> <span class="o">=</span> <span class="s">"admin"</span>

<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">:</span>
    <span class="s">"""User with security context"""</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Role</span><span class="p">]</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Permission</span><span class="p">]</span>
    <span class="n">ip_whitelist</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">has_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission</span><span class="p">:</span> <span class="n">Permission</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if user has specific permission"""</span>
        <span class="k">return</span> <span class="n">permission</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">permissions</span>
    
    <span class="k">def</span> <span class="nf">has_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">:</span> <span class="n">Role</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if user has specific role"""</span>
        <span class="k">return</span> <span class="n">role</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">roles</span>
    
    <span class="k">def</span> <span class="nf">is_ip_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Check if IP address is whitelisted"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">ip_whitelist</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>  <span class="c1"># No restrictions
</span>        
        <span class="k">return</span> <span class="n">ip_address</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">ip_whitelist</span>

<span class="k">class</span> <span class="nc">AccessControlManager</span><span class="p">:</span>
    <span class="s">"""
    Role-based access control system
    Enterprise access control from chipa.tech security platform
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">users</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">User</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">role_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_initialize_role_permissions</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">session_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># In production, use Redis or similar
</span>        
    <span class="k">def</span> <span class="nf">_initialize_role_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Role</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="n">Permission</span><span class="p">]]:</span>
        <span class="s">"""Initialize default role permissions"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">Role</span><span class="p">.</span><span class="n">VIEWER</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_BALANCE</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_MARKET_DATA</span>
            <span class="p">},</span>
            <span class="n">Role</span><span class="p">.</span><span class="n">TRADER</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_BALANCE</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_TRANSACTIONS</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_MARKET_DATA</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">EXECUTE_TRADES</span>
            <span class="p">},</span>
            <span class="n">Role</span><span class="p">.</span><span class="n">PREMIUM_TRADER</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_BALANCE</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_TRANSACTIONS</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">READ_MARKET_DATA</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">EXECUTE_TRADES</span><span class="p">,</span>
                <span class="n">Permission</span><span class="p">.</span><span class="n">MANAGE_WEBHOOKS</span>
            <span class="p">},</span>
            <span class="n">Role</span><span class="p">.</span><span class="n">ADMIN</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">Permission</span><span class="p">)</span>  <span class="c1"># All permissions
</span>        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">roles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Role</span><span class="p">],</span>
                   <span class="n">ip_whitelist</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="s">"""Create new user with specified roles"""</span>
        
        <span class="c1"># Calculate permissions from roles
</span>        <span class="n">permissions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">permissions</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">role_permissions</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="nb">set</span><span class="p">()))</span>
        
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span>
            <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">roles</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">roles</span><span class="p">),</span>
            <span class="n">permissions</span><span class="o">=</span><span class="n">permissions</span><span class="p">,</span>
            <span class="n">ip_whitelist</span><span class="o">=</span><span class="n">ip_whitelist</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">return</span> <span class="n">user</span>
    
    <span class="k">def</span> <span class="nf">authenticate_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span>
        <span class="s">"""Authenticate user and check access"""</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">users</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">.</span><span class="n">active</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"User account is inactive"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">.</span><span class="n">is_ip_allowed</span><span class="p">(</span><span class="n">ip_address</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"IP address </span><span class="si">{</span><span class="n">ip_address</span><span class="si">}</span><span class="s"> not whitelisted"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">user</span>
    
    <span class="k">def</span> <span class="nf">require_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission</span><span class="p">:</span> <span class="n">Permission</span><span class="p">):</span>
        <span class="s">"""Decorator for requiring specific permission"""</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="o">@</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="k">async</span> <span class="k">def</span> <span class="nf">async_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="c1"># Extract user from context (implementation specific)
</span>                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"Authentication required"</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">permission</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Permission </span><span class="si">{</span><span class="n">permission</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s"> required"</span><span class="p">)</span>
                
                <span class="k">return</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
            <span class="o">@</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">sync_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"Authentication required"</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">permission</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Permission </span><span class="si">{</span><span class="n">permission</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s"> required"</span><span class="p">)</span>
                
                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">async_wrapper</span> <span class="k">if</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">else</span> <span class="n">sync_wrapper</span>
        <span class="k">return</span> <span class="n">decorator</span>
    
    <span class="k">def</span> <span class="nf">_get_current_user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span>
        <span class="s">"""Get current user from context (implementation specific)"""</span>
        <span class="c1"># This would be implemented based on your authentication system
</span>        <span class="c1"># Could use thread-local storage, asyncio context vars, etc.
</span>        <span class="k">pass</span>

<span class="c1"># Usage example with AxiomTradeAPI
</span><span class="k">class</span> <span class="nc">SecureAxiomTradeAPI</span><span class="p">:</span>
    <span class="s">"""Secure AxiomTradeAPI with access control"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_manager</span><span class="p">:</span> <span class="n">SecureTokenManager</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">token_manager</span> <span class="o">=</span> <span class="n">token_manager</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">access_control</span> <span class="o">=</span> <span class="n">AccessControlManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">audit_logger</span> <span class="o">=</span> <span class="n">SecurityAuditLogger</span><span class="p">()</span>
    
    <span class="o">@</span><span class="n">AccessControlManager</span><span class="p">().</span><span class="n">require_permission</span><span class="p">(</span><span class="n">Permission</span><span class="p">.</span><span class="n">READ_BALANCE</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wallet_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Get wallet balance with access control"""</span>
        
        <span class="c1"># Log access attempt
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">audit_logger</span><span class="p">.</span><span class="n">log_access_attempt</span><span class="p">(</span>
            <span class="s">'get_balance'</span><span class="p">,</span>
            <span class="p">{</span><span class="s">'wallet_address'</span><span class="p">:</span> <span class="n">wallet_address</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="c1"># Implement actual balance retrieval
</span>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">_internal_get_balance</span><span class="p">(</span><span class="n">wallet_address</span><span class="p">)</span>
    
    <span class="o">@</span><span class="n">AccessControlManager</span><span class="p">().</span><span class="n">require_permission</span><span class="p">(</span><span class="n">Permission</span><span class="p">.</span><span class="n">EXECUTE_TRADES</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trade_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Execute trade with access control"""</span>
        
        <span class="c1"># Log trade attempt
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">audit_logger</span><span class="p">.</span><span class="n">log_access_attempt</span><span class="p">(</span>
            <span class="s">'execute_trade'</span><span class="p">,</span>
            <span class="p">{</span><span class="s">'trade_params'</span><span class="p">:</span> <span class="n">trade_params</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="c1"># Additional security checks for trades
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_validate_trade_params</span><span class="p">(</span><span class="n">trade_params</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SecurityError</span><span class="p">(</span><span class="s">"Invalid trade parameters"</span><span class="p">)</span>
        
        <span class="c1"># Implement actual trade execution
</span>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">_internal_execute_trade</span><span class="p">(</span><span class="n">trade_params</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_validate_trade_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">"""Validate trade parameters for security"""</span>
        <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'amount'</span><span class="p">,</span> <span class="s">'token_address'</span><span class="p">,</span> <span class="s">'wallet_address'</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># Additional validation logic
</span>        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_internal_get_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wallet_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Internal balance retrieval implementation"""</span>
        <span class="k">pass</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_internal_execute_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trade_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Internal trade execution implementation"""</span>
        <span class="k">pass</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="monitoring">Security Monitoring and Auditing</h2>

<p>Comprehensive security monitoring and audit logging:</p>

<h3 id="security-audit-logger">Security Audit Logger</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">asdict</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">SecurityEventType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""Security event types"""</span>
    <span class="n">LOGIN_SUCCESS</span> <span class="o">=</span> <span class="s">"login_success"</span>
    <span class="n">LOGIN_FAILURE</span> <span class="o">=</span> <span class="s">"login_failure"</span>
    <span class="n">API_ACCESS</span> <span class="o">=</span> <span class="s">"api_access"</span>
    <span class="n">PERMISSION_DENIED</span> <span class="o">=</span> <span class="s">"permission_denied"</span>
    <span class="n">TOKEN_ROTATION</span> <span class="o">=</span> <span class="s">"token_rotation"</span>
    <span class="n">SUSPICIOUS_ACTIVITY</span> <span class="o">=</span> <span class="s">"suspicious_activity"</span>
    <span class="n">DATA_ACCESS</span> <span class="o">=</span> <span class="s">"data_access"</span>
    <span class="n">SECURITY_VIOLATION</span> <span class="o">=</span> <span class="s">"security_violation"</span>

<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">SecurityEvent</span><span class="p">:</span>
    <span class="s">"""Security event record"""</span>
    <span class="n">event_type</span><span class="p">:</span> <span class="n">SecurityEventType</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">user_agent</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">risk_level</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Convert to dictionary for logging"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'event_type'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">event_type</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s">'user_id'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="s">'ip_address'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">ip_address</span><span class="p">,</span>
            <span class="s">'user_agent'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_agent</span><span class="p">,</span>
            <span class="s">'timestamp'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="s">'datetime'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span><span class="p">).</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s">'details'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">details</span><span class="p">,</span>
            <span class="s">'risk_level'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">risk_level</span><span class="p">,</span>
            <span class="s">'session_id'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">session_id</span>
        <span class="p">}</span>

<span class="k">class</span> <span class="nc">SecurityAuditLogger</span><span class="p">:</span>
    <span class="s">"""
    Comprehensive security audit logging system
    Security monitoring from chipa.tech security operations center
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"security_audit.log"</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">risk_analyzer</span> <span class="o">=</span> <span class="n">SecurityRiskAnalyzer</span><span class="p">()</span>
        
        <span class="c1"># Setup security logger
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">'security_audit'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
        
        <span class="c1"># File handler for security events
</span>        <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="s">'%(asctime)s - SECURITY - %(levelname)s - %(message)s'</span>
        <span class="p">)</span>
        <span class="n">handler</span><span class="p">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">log_security_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="n">SecurityEventType</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
                          <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s">"""Log security event"""</span>
        
        <span class="c1"># Analyze risk level
</span>        <span class="n">risk_level</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">risk_analyzer</span><span class="p">.</span><span class="n">calculate_risk_level</span><span class="p">(</span>
            <span class="n">event_type</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">,</span> <span class="n">details</span>
        <span class="p">)</span>
        
        <span class="c1"># Create security event
</span>        <span class="n">event</span> <span class="o">=</span> <span class="n">SecurityEvent</span><span class="p">(</span>
            <span class="n">event_type</span><span class="o">=</span><span class="n">event_type</span><span class="p">,</span>
            <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">ip_address</span><span class="o">=</span><span class="n">ip_address</span><span class="p">,</span>
            <span class="n">user_agent</span><span class="o">=</span><span class="n">user_agent</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">(),</span>
            <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">,</span>
            <span class="n">risk_level</span><span class="o">=</span><span class="n">risk_level</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span>
        <span class="p">)</span>
        
        <span class="c1"># Log event
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">to_dict</span><span class="p">()))</span>
        
        <span class="c1"># Handle high-risk events
</span>        <span class="k">if</span> <span class="n">risk_level</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'HIGH'</span><span class="p">,</span> <span class="s">'CRITICAL'</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_handle_high_risk_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">log_access_attempt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
                          <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s">"""Log API access attempt"""</span>
        
        <span class="c1"># Get user context (implementation specific)
</span>        <span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_id</span><span class="p">()</span>
        <span class="n">ip_address</span> <span class="o">=</span> <span class="n">ip_address</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_ip</span><span class="p">()</span>
        <span class="n">user_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_agent</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">log_security_event</span><span class="p">(</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">API_ACCESS</span><span class="p">,</span>
            <span class="n">user_id</span><span class="p">,</span>
            <span class="n">ip_address</span><span class="p">,</span>
            <span class="n">user_agent</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s">'operation'</span><span class="p">:</span> <span class="n">operation</span><span class="p">,</span>
                <span class="s">'parameters'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_sanitize_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">log_permission_denied</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">required_permission</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                             <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s">"""Log permission denied event"""</span>
        
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_id</span><span class="p">()</span>
        <span class="n">ip_address</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_ip</span><span class="p">()</span>
        <span class="n">user_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_agent</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">log_security_event</span><span class="p">(</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">PERMISSION_DENIED</span><span class="p">,</span>
            <span class="n">user_id</span><span class="p">,</span>
            <span class="n">ip_address</span><span class="p">,</span>
            <span class="n">user_agent</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s">'operation'</span><span class="p">:</span> <span class="n">operation</span><span class="p">,</span>
                <span class="s">'required_permission'</span><span class="p">:</span> <span class="n">required_permission</span>
            <span class="p">}</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">log_suspicious_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="s">"""Log suspicious activity"""</span>
        
        <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_id</span><span class="p">()</span>
        <span class="n">ip_address</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_ip</span><span class="p">()</span>
        <span class="n">user_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_get_current_user_agent</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">log_security_event</span><span class="p">(</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">SUSPICIOUS_ACTIVITY</span><span class="p">,</span>
            <span class="n">user_id</span><span class="p">,</span>
            <span class="n">ip_address</span><span class="p">,</span>
            <span class="n">user_agent</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s">'activity_type'</span><span class="p">:</span> <span class="n">activity_type</span><span class="p">,</span>
                <span class="s">'details'</span><span class="p">:</span> <span class="n">details</span>
            <span class="p">}</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_handle_high_risk_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
        <span class="s">"""Handle high-risk security events"""</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🚨 HIGH RISK SECURITY EVENT: </span><span class="si">{</span><span class="n">event</span><span class="p">.</span><span class="n">event_type</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   User: </span><span class="si">{</span><span class="n">event</span><span class="p">.</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   IP: </span><span class="si">{</span><span class="n">event</span><span class="p">.</span><span class="n">ip_address</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   Risk Level: </span><span class="si">{</span><span class="n">event</span><span class="p">.</span><span class="n">risk_level</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># In production, this would:
</span>        <span class="c1"># - Send alerts to security team
</span>        <span class="c1"># - Trigger automated responses
</span>        <span class="c1"># - Update threat intelligence
</span>        <span class="c1"># - Potentially block IP/user
</span>    
    <span class="k">def</span> <span class="nf">_sanitize_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Sanitize parameters for logging"""</span>
        <span class="n">sanitized</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sensitive_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">'token'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">,</span> <span class="s">'secret'</span><span class="p">,</span> <span class="s">'key'</span><span class="p">,</span> <span class="s">'private'</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">sensitive</span> <span class="ow">in</span> <span class="n">key</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">sensitive</span> <span class="ow">in</span> <span class="n">sensitive_keys</span><span class="p">):</span>
                <span class="n">sanitized</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s">"[REDACTED]"</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sanitized</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span>  <span class="c1"># Limit length
</span>        
        <span class="k">return</span> <span class="n">sanitized</span>
    
    <span class="k">def</span> <span class="nf">_get_current_user_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Get current user ID from context"""</span>
        <span class="c1"># Implementation specific
</span>        <span class="k">return</span> <span class="s">"unknown"</span>
    
    <span class="k">def</span> <span class="nf">_get_current_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Get current IP address from context"""</span>
        <span class="c1"># Implementation specific
</span>        <span class="k">return</span> <span class="s">"0.0.0.0"</span>
    
    <span class="k">def</span> <span class="nf">_get_current_user_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Get current user agent from context"""</span>
        <span class="c1"># Implementation specific
</span>        <span class="k">return</span> <span class="s">"Unknown"</span>

<span class="k">class</span> <span class="nc">SecurityRiskAnalyzer</span><span class="p">:</span>
    <span class="s">"""Analyze security risk levels"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">risk_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_load_risk_patterns</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_behavior_baselines</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">calculate_risk_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="n">SecurityEventType</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                           <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Calculate risk level for security event"""</span>
        
        <span class="n">risk_score</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Base risk by event type
</span>        <span class="n">base_risks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">LOGIN_FAILURE</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">PERMISSION_DENIED</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">SUSPICIOUS_ACTIVITY</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">SECURITY_VIOLATION</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
            <span class="n">SecurityEventType</span><span class="p">.</span><span class="n">API_ACCESS</span><span class="p">:</span> <span class="mi">5</span>
        <span class="p">}</span>
        
        <span class="n">risk_score</span> <span class="o">+=</span> <span class="n">base_risks</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># IP-based risk factors
</span>        <span class="n">risk_score</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_analyze_ip_risk</span><span class="p">(</span><span class="n">ip_address</span><span class="p">)</span>
        
        <span class="c1"># User behavior analysis
</span>        <span class="n">risk_score</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_analyze_user_behavior</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">event_type</span><span class="p">)</span>
        
        <span class="c1"># Time-based analysis
</span>        <span class="n">risk_score</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_analyze_time_patterns</span><span class="p">()</span>
        
        <span class="c1"># Convert score to risk level
</span>        <span class="k">if</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"CRITICAL"</span>
        <span class="k">elif</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"HIGH"</span>
        <span class="k">elif</span> <span class="n">risk_score</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"MEDIUM"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"LOW"</span>
    
    <span class="k">def</span> <span class="nf">_analyze_ip_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s">"""Analyze IP address risk factors"""</span>
        <span class="n">risk</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Check against known threat IPs
</span>        <span class="c1"># In production, this would check against threat intelligence feeds
</span>        
        <span class="c1"># Check for unusual geographic locations
</span>        <span class="c1"># Implementation would use GeoIP services
</span>        
        <span class="k">return</span> <span class="n">risk</span>
    
    <span class="k">def</span> <span class="nf">_analyze_user_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="n">SecurityEventType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s">"""Analyze user behavior patterns"""</span>
        <span class="n">risk</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Check deviation from normal behavior patterns
</span>        <span class="c1"># This would analyze historical user behavior
</span>        
        <span class="k">return</span> <span class="n">risk</span>
    
    <span class="k">def</span> <span class="nf">_analyze_time_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s">"""Analyze time-based risk patterns"""</span>
        <span class="n">risk</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Check for unusual access times
</span>        <span class="n">current_hour</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">hour</span>
        
        <span class="c1"># Higher risk for access during unusual hours (e.g., 2-6 AM)
</span>        <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">current_hour</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">risk</span> <span class="o">+=</span> <span class="mi">10</span>
        
        <span class="k">return</span> <span class="n">risk</span>
    
    <span class="k">def</span> <span class="nf">_load_risk_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Load risk analysis patterns"""</span>
        <span class="c1"># In production, this would load from configuration or ML models
</span>        <span class="k">return</span> <span class="p">{}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="incident-response">Incident Response</h2>

<p>Structured incident response procedures:</p>

<h3 id="security-incident-management">Security Incident Management</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">class</span> <span class="nc">IncidentSeverity</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""Incident severity levels"""</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s">"low"</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s">"medium"</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s">"high"</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s">"critical"</span>

<span class="k">class</span> <span class="nc">IncidentStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="s">"""Incident status"""</span>
    <span class="n">DETECTED</span> <span class="o">=</span> <span class="s">"detected"</span>
    <span class="n">INVESTIGATING</span> <span class="o">=</span> <span class="s">"investigating"</span>
    <span class="n">CONTAINING</span> <span class="o">=</span> <span class="s">"containing"</span>
    <span class="n">RESOLVED</span> <span class="o">=</span> <span class="s">"resolved"</span>
    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s">"closed"</span>

<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">SecurityIncident</span><span class="p">:</span>
    <span class="s">"""Security incident record"""</span>
    <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="n">IncidentSeverity</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">IncidentStatus</span>
    <span class="n">affected_systems</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">detection_time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">assignee</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    
<span class="k">class</span> <span class="nc">SecurityIncidentManager</span><span class="p">:</span>
    <span class="s">"""
    Security incident response management
    Incident response procedures from chipa.tech security team
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SecurityIncident</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">response_handlers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">IncidentSeverity</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">severity</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="n">IncidentSeverity</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">notification_channels</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">register_response_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="n">IncidentSeverity</span><span class="p">,</span>
                                 <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">SecurityIncident</span><span class="p">],</span> <span class="bp">None</span><span class="p">]):</span>
        <span class="s">"""Register incident response handler"""</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">response_handlers</span><span class="p">[</span><span class="n">severity</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">create_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="n">IncidentSeverity</span><span class="p">,</span>
                       <span class="n">affected_systems</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Create new security incident"""</span>
        
        <span class="n">incident_id</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_generate_incident_id</span><span class="p">()</span>
        
        <span class="n">incident</span> <span class="o">=</span> <span class="n">SecurityIncident</span><span class="p">(</span>
            <span class="n">incident_id</span><span class="o">=</span><span class="n">incident_id</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">IncidentStatus</span><span class="p">.</span><span class="n">DETECTED</span><span class="p">,</span>
            <span class="n">affected_systems</span><span class="o">=</span><span class="n">affected_systems</span><span class="p">,</span>
            <span class="n">detection_time</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">(),</span>
            <span class="n">assignee</span><span class="o">=</span><span class="s">""</span><span class="p">,</span>
            <span class="n">details</span><span class="o">=</span><span class="n">details</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">[</span><span class="n">incident_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">incident</span>
        
        <span class="c1"># Trigger incident response
</span>        <span class="n">asyncio</span><span class="p">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_trigger_incident_response</span><span class="p">(</span><span class="n">incident</span><span class="p">))</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🚨 Security incident created: </span><span class="si">{</span><span class="n">incident_id</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">incident_id</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_trigger_incident_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">SecurityIncident</span><span class="p">):</span>
        <span class="s">"""Trigger appropriate incident response procedures"""</span>
        
        <span class="c1"># Execute response handlers
</span>        <span class="n">handlers</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">response_handlers</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="p">.</span><span class="n">severity</span><span class="p">,</span> <span class="p">[])</span>
        
        <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">handlers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">handler</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Incident response handler failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Send notifications
</span>        <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">_send_incident_notifications</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
        
        <span class="c1"># Auto-assign based on severity
</span>        <span class="k">if</span> <span class="n">incident</span><span class="p">.</span><span class="n">severity</span> <span class="ow">in</span> <span class="p">[</span><span class="n">IncidentSeverity</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span> <span class="n">IncidentSeverity</span><span class="p">.</span><span class="n">CRITICAL</span><span class="p">]:</span>
            <span class="n">incident</span><span class="p">.</span><span class="n">assignee</span> <span class="o">=</span> <span class="s">"security-team-lead"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">incident</span><span class="p">.</span><span class="n">assignee</span> <span class="o">=</span> <span class="s">"security-analyst"</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_incident_notifications</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">SecurityIncident</span><span class="p">):</span>
        <span class="s">"""Send incident notifications"""</span>
        
        <span class="n">notification_message</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'incident_id'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="p">,</span>
            <span class="s">'title'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s">'severity'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">severity</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s">'status'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
            <span class="s">'affected_systems'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">affected_systems</span><span class="p">,</span>
            <span class="s">'detection_time'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">detection_time</span>
        <span class="p">}</span>
        
        <span class="c1"># Send to configured notification channels
</span>        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">notification_channels</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">channel</span><span class="p">.</span><span class="n">send_notification</span><span class="p">(</span><span class="n">notification_message</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"❌ Failed to send notification: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">update_incident_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">IncidentStatus</span><span class="p">,</span>
                              <span class="n">notes</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">""</span><span class="p">):</span>
        <span class="s">"""Update incident status"""</span>
        
        <span class="k">if</span> <span class="n">incident_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Incident </span><span class="si">{</span><span class="n">incident_id</span><span class="si">}</span><span class="s"> not found"</span><span class="p">)</span>
        
        <span class="n">incident</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">[</span><span class="n">incident_id</span><span class="p">]</span>
        <span class="n">old_status</span> <span class="o">=</span> <span class="n">incident</span><span class="p">.</span><span class="n">status</span>
        <span class="n">incident</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
        
        <span class="c1"># Log status change
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"📝 Incident </span><span class="si">{</span><span class="n">incident_id</span><span class="si">}</span><span class="s"> status: </span><span class="si">{</span><span class="n">old_status</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s"> -&gt; </span><span class="si">{</span><span class="n">status</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">notes</span><span class="p">:</span>
            <span class="n">incident</span><span class="p">.</span><span class="n">details</span><span class="p">[</span><span class="s">'status_notes'</span><span class="p">]</span> <span class="o">=</span> <span class="n">incident</span><span class="p">.</span><span class="n">details</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'status_notes'</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">incident</span><span class="p">.</span><span class="n">details</span><span class="p">[</span><span class="s">'status_notes'</span><span class="p">].</span><span class="n">append</span><span class="p">({</span>
                <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">(),</span>
                <span class="s">'status'</span><span class="p">:</span> <span class="n">status</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s">'notes'</span><span class="p">:</span> <span class="n">notes</span>
            <span class="p">})</span>
    
    <span class="k">def</span> <span class="nf">get_incident_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Get summary of all incidents"""</span>
        
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'total_incidents'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">),</span>
            <span class="s">'by_severity'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s">'by_status'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s">'open_incidents'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">incident</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">incidents</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1"># Count by severity
</span>            <span class="n">severity</span> <span class="o">=</span> <span class="n">incident</span><span class="p">.</span><span class="n">severity</span><span class="p">.</span><span class="n">value</span>
            <span class="n">summary</span><span class="p">[</span><span class="s">'by_severity'</span><span class="p">][</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s">'by_severity'</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="c1"># Count by status
</span>            <span class="n">status</span> <span class="o">=</span> <span class="n">incident</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">value</span>
            <span class="n">summary</span><span class="p">[</span><span class="s">'by_status'</span><span class="p">][</span><span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s">'by_status'</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="c1"># Add open incidents
</span>            <span class="k">if</span> <span class="n">incident</span><span class="p">.</span><span class="n">status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">IncidentStatus</span><span class="p">.</span><span class="n">RESOLVED</span><span class="p">,</span> <span class="n">IncidentStatus</span><span class="p">.</span><span class="n">CLOSED</span><span class="p">]:</span>
                <span class="n">summary</span><span class="p">[</span><span class="s">'open_incidents'</span><span class="p">].</span><span class="n">append</span><span class="p">({</span>
                    <span class="s">'id'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="p">,</span>
                    <span class="s">'title'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
                    <span class="s">'severity'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">severity</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="s">'status'</span><span class="p">:</span> <span class="n">incident</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="s">'age_hours'</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">incident</span><span class="p">.</span><span class="n">detection_time</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3600</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">summary</span>
    
    <span class="k">def</span> <span class="nf">_generate_incident_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Generate unique incident ID"""</span>
        <span class="kn">import</span> <span class="nn">uuid</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"INC-</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">())[</span><span class="si">:</span><span class="mi">8</span><span class="p">].</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s">"</span>

<span class="c1"># Pre-defined incident response procedures
</span><span class="k">class</span> <span class="nc">IncidentResponseProcedures</span><span class="p">:</span>
    <span class="s">"""Pre-defined incident response procedures"""</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">critical_incident_response</span><span class="p">(</span><span class="n">incident</span><span class="p">:</span> <span class="n">SecurityIncident</span><span class="p">):</span>
        <span class="s">"""Response procedure for critical incidents"""</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🚨 CRITICAL INCIDENT RESPONSE: </span><span class="si">{</span><span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Immediate actions for critical incidents
</span>        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">"Notify security team immediately"</span><span class="p">,</span>
            <span class="s">"Escalate to management"</span><span class="p">,</span>
            <span class="s">"Consider system isolation"</span><span class="p">,</span>
            <span class="s">"Activate incident command center"</span><span class="p">,</span>
            <span class="s">"Begin evidence collection"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   ✓ </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">high_incident_response</span><span class="p">(</span><span class="n">incident</span><span class="p">:</span> <span class="n">SecurityIncident</span><span class="p">):</span>
        <span class="s">"""Response procedure for high severity incidents"""</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"⚠️ HIGH SEVERITY INCIDENT RESPONSE: </span><span class="si">{</span><span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">"Notify security team"</span><span class="p">,</span>
            <span class="s">"Begin investigation"</span><span class="p">,</span>
            <span class="s">"Document evidence"</span><span class="p">,</span>
            <span class="s">"Assess impact scope"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   ✓ </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">automated_containment</span><span class="p">(</span><span class="n">incident</span><span class="p">:</span> <span class="n">SecurityIncident</span><span class="p">):</span>
        <span class="s">"""Automated containment actions"""</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🛡️ AUTOMATED CONTAINMENT: </span><span class="si">{</span><span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Example automated containment actions
</span>        <span class="k">if</span> <span class="s">"authentication"</span> <span class="ow">in</span> <span class="n">incident</span><span class="p">.</span><span class="n">details</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'indicators'</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"   ✓ Temporarily suspending affected user accounts"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s">"network"</span> <span class="ow">in</span> <span class="n">incident</span><span class="p">.</span><span class="n">affected_systems</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"   ✓ Applying network access restrictions"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s">"api"</span> <span class="ow">in</span> <span class="n">incident</span><span class="p">.</span><span class="n">affected_systems</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"   ✓ Enabling enhanced API monitoring"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="best-practices-summary">Best Practices Summary</h2>

<h3 id="security-implementation-checklist">Security Implementation Checklist</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre>🔒 AxiomTradeAPI Security Checklist
==================================

🔐 Authentication &amp; Authorization:
□ API tokens encrypted at rest
□ Token rotation implemented
□ Role-based access control configured
□ Session management implemented
□ Multi-factor authentication (if available)

🌐 Network Security:
□ HTTPS enforced for all communications
□ Request signing implemented
□ IP whitelisting configured
□ Rate limiting enabled
□ Circuit breakers implemented

💾 Data Protection:
□ Sensitive data encrypted at rest
□ Secure data transmission
□ PII/sensitive data sanitized in logs
□ Secure file deletion procedures
□ Data retention policies defined

🔍 Monitoring &amp; Auditing:
□ Security event logging enabled
□ Anomaly detection configured
□ Regular security assessments
□ Incident response procedures defined
□ Compliance monitoring active

🛡️ Infrastructure Security:
□ Secure configuration management
□ Regular security updates
□ Backup and recovery procedures
□ Environment isolation
□ Secure deployment practices
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="compliance">Compliance and Regulations</h2>

<h3 id="regulatory-compliance-framework">Regulatory Compliance Framework</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">ComplianceFramework</span><span class="p">:</span>
    <span class="s">"""
    Regulatory compliance framework for trading applications
    Compliance best practices from chipa.tech legal and compliance team
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">compliance_checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'data_protection'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_check_data_protection_compliance</span><span class="p">,</span>
            <span class="s">'financial_regulations'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_check_financial_compliance</span><span class="p">,</span>
            <span class="s">'audit_requirements'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_check_audit_compliance</span><span class="p">,</span>
            <span class="s">'access_controls'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_check_access_control_compliance</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">run_compliance_assessment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Run comprehensive compliance assessment"""</span>
        
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">check_name</span><span class="p">,</span> <span class="n">check_function</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">compliance_checks</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">check_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_function</span><span class="p">()</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">check_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">'status'</span><span class="p">:</span> <span class="s">'ERROR'</span><span class="p">,</span>
                    <span class="s">'error'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="p">}</span>
        
        <span class="c1"># Calculate overall compliance score
</span>        <span class="n">passed_checks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">.</span><span class="n">values</span><span class="p">()</span> 
                           <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'status'</span><span class="p">)</span> <span class="o">==</span> <span class="s">'PASS'</span><span class="p">)</span>
        <span class="n">total_checks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="n">compliance_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">passed_checks</span> <span class="o">/</span> <span class="n">total_checks</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'compliance_score'</span><span class="p">:</span> <span class="n">compliance_score</span><span class="p">,</span>
            <span class="s">'detailed_results'</span><span class="p">:</span> <span class="n">results</span><span class="p">,</span>
            <span class="s">'recommendations'</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">_generate_compliance_recommendations</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_check_data_protection_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Check data protection compliance (GDPR, CCPA, etc.)"""</span>
        
        <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'data_encryption'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="c1"># Check if data is encrypted
</span>            <span class="s">'access_logging'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>   <span class="c1"># Check if access is logged
</span>            <span class="s">'data_retention'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>   <span class="c1"># Check retention policies
</span>            <span class="s">'user_consent'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>     <span class="c1"># Check consent mechanisms
</span>            <span class="s">'data_minimization'</span><span class="p">:</span> <span class="bp">True</span> <span class="c1"># Check data minimization
</span>        <span class="p">}</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'status'</span><span class="p">:</span> <span class="s">'PASS'</span> <span class="k">if</span> <span class="n">passed</span> <span class="k">else</span> <span class="s">'FAIL'</span><span class="p">,</span>
            <span class="s">'checks'</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
            <span class="s">'requirements_met'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span>
            <span class="s">'total_requirements'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_check_financial_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Check financial regulations compliance"""</span>
        
        <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'transaction_logging'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'audit_trail'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'user_verification'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'suspicious_activity_monitoring'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'regulatory_reporting'</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'status'</span><span class="p">:</span> <span class="s">'PASS'</span> <span class="k">if</span> <span class="n">passed</span> <span class="k">else</span> <span class="s">'FAIL'</span><span class="p">,</span>
            <span class="s">'checks'</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
            <span class="s">'requirements_met'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span>
            <span class="s">'total_requirements'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_check_audit_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Check audit requirements compliance"""</span>
        
        <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'comprehensive_logging'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'log_integrity'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'access_controls'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'change_management'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'incident_response'</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'status'</span><span class="p">:</span> <span class="s">'PASS'</span> <span class="k">if</span> <span class="n">passed</span> <span class="k">else</span> <span class="s">'FAIL'</span><span class="p">,</span>
            <span class="s">'checks'</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
            <span class="s">'requirements_met'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span>
            <span class="s">'total_requirements'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_check_access_control_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="s">"""Check access control compliance"""</span>
        
        <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'role_based_access'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'principle_of_least_privilege'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'regular_access_reviews'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'privileged_access_monitoring'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'session_management'</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'status'</span><span class="p">:</span> <span class="s">'PASS'</span> <span class="k">if</span> <span class="n">passed</span> <span class="k">else</span> <span class="s">'FAIL'</span><span class="p">,</span>
            <span class="s">'checks'</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
            <span class="s">'requirements_met'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span>
            <span class="s">'total_requirements'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_generate_compliance_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="s">"""Generate compliance improvement recommendations"""</span>
        
        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'status'</span><span class="p">)</span> <span class="o">==</span> <span class="s">'FAIL'</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">area</span> <span class="o">==</span> <span class="s">'data_protection'</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">"Implement comprehensive data protection measures"</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">area</span> <span class="o">==</span> <span class="s">'financial_regulations'</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">"Enhance financial compliance monitoring"</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">area</span> <span class="o">==</span> <span class="s">'audit_requirements'</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">"Improve audit trail capabilities"</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">area</span> <span class="o">==</span> <span class="s">'access_controls'</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">"Strengthen access control mechanisms"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">recommendations</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="community-and-resources">Community and Resources</h2>

<p>For security support and best practices:</p>

<ul>
  <li>🔒 <strong>Security Documentation</strong>: <a href="https://chipa.tech/security">chipa.tech/security</a></li>
  <li>🛡️ <strong>Security Best Practices</strong>: <a href="https://chipa.tech/security-guide">chipa.tech/security-guide</a></li>
  <li>🚨 <strong>Security Alerts</strong>: <a href="https://chipa.tech/security-alerts">chipa.tech/security-alerts</a></li>
  <li>💬 <strong>Security Discord</strong>: <a href="https://chipa.tech/security-discord">chipa.tech/security-discord</a></li>
  <li>🔍 <strong>Security Audits</strong>: <a href="https://chipa.tech/security-audits">chipa.tech/security-audits</a></li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>Security is not a one-time implementation but an ongoing process that requires constant vigilance and updates. This guide provides a comprehensive framework for implementing security best practices with AxiomTradeAPI.</p>

<p>Key security principles:</p>
<ul>
  <li><strong>Defense in Depth</strong>: Multiple layers of security controls</li>
  <li><strong>Principle of Least Privilege</strong>: Minimal necessary access rights</li>
  <li><strong>Zero Trust</strong>: Verify everything, trust nothing</li>
  <li><strong>Continuous Monitoring</strong>: Ongoing security assessment</li>
  <li><strong>Incident Preparedness</strong>: Ready to respond to security events</li>
</ul>

<p>Stay connected with the <a href="https://chipa.tech/security">chipa.tech security community</a> for the latest security updates, threat intelligence, and best practices.</p>

<hr />

<p><em>This security guide represents enterprise-grade security practices for financial applications. Security requirements may vary based on jurisdiction and use case. Always consult with security professionals and legal experts for your specific needs. Visit <a href="https://chipa.tech">chipa.tech</a> for the latest security guidance.</em></p>

  </div>

  <!-- What's Next Section -->
  

  <!-- Related Guides -->
  

  <!-- Community Section -->
  <div class="community-section">
    <div class="community-card">
      <h3>Get Help from the Community</h3>
      <p>
        Join thousands of traders using AxiomTradeAPI on the 
        <a href="https://chipa.tech" class="chipa-link">chipa.tech platform</a>. 
        Share strategies, get help, and discover new opportunities.
      </p>
      <div class="community-actions">
        <a href="https://discord.gg/p7YyFqSmAz" class="btn btn-primary" target="_blank">
          <i class="fab fa-discord"></i>
          Join Discord Community
        </a>
        <a href="https://chipa.tech/product/create-your-bot" class="btn btn-secondary" target="_blank">
          <i class="fas fa-cogs"></i>
          Get Custom Bot
        </a>
      </div>
    </div>
  </div>

  <!-- Feedback Section -->
  <div class="feedback-section">
    <div class="feedback-card">
      <h4>Was this guide helpful?</h4>
      <p>Help us improve our documentation by sharing your feedback.</p>
      <div class="feedback-buttons">
        <button class="feedback-btn positive" onclick="submitFeedback('positive')">
          <i class="fas fa-thumbs-up"></i>
          Yes, helpful
        </button>
        <button class="feedback-btn negative" onclick="submitFeedback('negative')">
          <i class="fas fa-thumbs-down"></i>
          Needs improvement
        </button>
      </div>
    </div>
  </div>
</div>

<script>
// Generate Table of Contents
document.addEventListener('DOMContentLoaded', function() {
  const tocContent = document.getElementById('toc-content');
  if (tocContent) {
    const headings = document.querySelectorAll('.guide-content h2, .guide-content h3');
    if (headings.length > 0) {
      const tocList = document.createElement('ul');
      tocList.className = 'toc-list';
      
      headings.forEach((heading, index) => {
        const id = heading.id || `heading-${index}`;
        heading.id = id;
        
        const listItem = document.createElement('li');
        listItem.className = `toc-item toc-${heading.tagName.toLowerCase()}`;
        
        const link = document.createElement('a');
        link.href = `#${id}`;
        link.textContent = heading.textContent;
        link.className = 'toc-link';
        
        listItem.appendChild(link);
        tocList.appendChild(listItem);
      });
      
      tocContent.appendChild(tocList);
    } else {
      tocContent.parentElement.style.display = 'none';
    }
  }
});

// Feedback functionality
function submitFeedback(type) {
  // In a real implementation, this would send feedback to your analytics
  const message = type === 'positive' ? 'Thank you for your feedback!' : 'Thank you! We\'ll work on improving this guide.';
  
  // Show feedback message
  const feedbackCard = document.querySelector('.feedback-card');
  feedbackCard.innerHTML = `
    <div class="feedback-success">
      <i class="fas fa-check-circle"></i>
      <p>${message}</p>
    </div>
  `;
}
</script>

          </div>

          <!-- Article Footer -->
          <footer class="article-footer">
            <div class="footer-actions">
              <a href="https://github.com/vigowalker/AxiomTradeAPI-py-1/edit/main/docs/security.md" class="edit-link" target="_blank">
                <i class="fas fa-edit"></i>
                Edit this page
              </a>
              
              <div class="share-buttons">
                <span class="share-label">Share:</span>
                <a href="https://twitter.com/intent/tweet?text=Security+Best+Practices+-+AxiomTradeAPI&url=https://chipadevteam.github.io/AxiomTradeAPI-py/security/" class="share-btn twitter" target="_blank">
                  <i class="fab fa-twitter"></i>
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://chipadevteam.github.io/AxiomTradeAPI-py/security/" class="share-btn linkedin" target="_blank">
                  <i class="fab fa-linkedin"></i>
                </a>
              </div>
            </div>

            <!-- Next/Previous Navigation -->
            
          </footer>
        </article>
      </div>
    </div>
  </main>
</div>

        </div>
    </main>

    <!-- Footer -->
    <!-- AxiomTradeAPI Documentation Footer Component -->
<footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <!-- Main footer sections -->
      <div class="footer-sections">
        <div class="footer-section">
          <h3 class="footer-title">AxiomTradeAPI</h3>
          <p class="footer-description">
            The most comprehensive Python library for building profitable Solana trading bots. 
            Used by successful traders on <a href="https://chipa.tech" class="chipa-link">chipa.tech</a>.
          </p>
          <div class="footer-stats">
            <div class="stat-item">
              <span class="stat-number">99.9%</span>
              <span class="stat-label">Uptime</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">&lt;50ms</span>
              <span class="stat-label">Latency</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">24/7</span>
              <span class="stat-label">Support</span>
            </div>
          </div>
        </div>
        
        <div class="footer-section">
          <h4 class="footer-section-title">Getting Started</h4>
          <ul class="footer-links">
            <li><a href="/AxiomTradeAPI-py/installation">Installation</a></li>
            <li><a href="/AxiomTradeAPI-py/authentication">Authentication</a></li>
            <li><a href="/AxiomTradeAPI-py/trading-bots">First Trading Bot</a></li>
            <li><a href="/AxiomTradeAPI-py/websocket-guide">WebSocket Setup</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4 class="footer-section-title">Features</h4>
          <ul class="footer-links">
            <li><a href="/AxiomTradeAPI-py/balance-queries">Balance Queries</a></li>
            <li><a href="/AxiomTradeAPI-py/performance">Performance</a></li>
            <li><a href="/AxiomTradeAPI-py/security">Security</a></li>
            <li><a href="/AxiomTradeAPI-py/error-handling">Error Handling</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4 class="footer-section-title">Resources</h4>
          <ul class="footer-links">
            <li><a href="/AxiomTradeAPI-py/api-reference">API Reference</a></li>
            <li><a href="/AxiomTradeAPI-py/examples">Code Examples</a></li>
            <li><a href="https://github.com/vigowalker/AxiomTradeAPI-py-1" target="_blank">GitHub Repository</a></li>
            <li><a href="https://chipa.tech" target="_blank">chipa.tech Platform</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4 class="footer-section-title">Community</h4>
          <ul class="footer-links">
            <li><a href="https://discord.gg/p7YyFqSmAz" target="_blank">Discord Community</a></li>
            <li><a href="https://chipa.tech/shop" target="_blank">chipa.tech Shop</a></li>
            <li><a href="https://chipa.tech/product/create-your-bot" target="_blank">Custom Bot Development</a></li>
            <li><a href="mailto:support@chipa.tech">Support Email</a></li>
          </ul>
        </div>
      </div>
      
      <!-- Newsletter signup -->
      <div class="footer-newsletter">
        <div class="newsletter-content">
          <h3>Stay Updated</h3>
          <p>Get the latest trading strategies and API updates from the chipa.tech community.</p>
          <form class="newsletter-form" onsubmit="subscribeNewsletter(event)">
            <input type="email" placeholder="Enter your email" class="newsletter-input" required>
            <button type="submit" class="newsletter-btn">
              <i class="fas fa-paper-plane"></i>
              Subscribe
            </button>
          </form>
          <p class="newsletter-disclaimer">
            We respect your privacy. Unsubscribe at any time. 
            <a href="https://chipa.tech/privacy" target="_blank">Privacy Policy</a>
          </p>
        </div>
      </div>
      
      <!-- Social links -->
      <div class="footer-social">
        <h4>Connect with chipa.tech</h4>
        <div class="social-links">
          <a href="https://discord.gg/p7YyFqSmAz" target="_blank" aria-label="Join Discord">
            <i class="fab fa-discord"></i>
          </a>
          <a href="https://twitter.com/chipatech" target="_blank" aria-label="Follow on Twitter">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="https://github.com/vigowalker" target="_blank" aria-label="GitHub">
            <i class="fab fa-github"></i>
          </a>
          <a href="https://chipa.tech" target="_blank" aria-label="Visit chipa.tech">
            <i class="fas fa-globe"></i>
          </a>
        </div>
      </div>
    </div>
    
    <!-- Bottom footer -->
    <div class="footer-bottom">
      <div class="footer-bottom-content">
        <div class="footer-left">
          <p>&copy; 2025 <a href="https://chipa.tech" class="chipa-link">chipa.tech</a>. All rights reserved.</p>
          <p class="footer-note">
            Built with ❤️ for the Solana trading community. 
            Powered by <a href="https://pages.github.com" target="_blank">GitHub Pages</a>.
          </p>
        </div>
        
        <div class="footer-right">
          <div class="footer-links-inline">
            <a href="https://chipa.tech/privacy" target="_blank">Privacy Policy</a>
            <a href="https://chipa.tech/terms" target="_blank">Terms of Service</a>
            <a href="/AxiomTradeAPI-py/sitemap.xml" target="_blank">Sitemap</a>
          </div>
          
          <!-- Performance indicator -->
          <div class="performance-indicator" id="performance-indicator">
            <span class="performance-label">Load time:</span>
            <span class="performance-value" id="load-time">--ms</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Back to top button -->
  <button class="back-to-top" id="back-to-top" onclick="scrollToTop()" aria-label="Back to top">
    <i class="fas fa-arrow-up"></i>
  </button>
</footer>

<style>
/* Footer styles */
.site-footer {
  background: var(--dark-bg-secondary);
  color: var(--dark-text-secondary);
  margin-top: 4rem;
}

.footer-content {
  padding: 3rem 0;
}

.footer-sections {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
  gap: 2rem;
  margin-bottom: 3rem;
}

.footer-section {
  /* Individual section styles */
}

.footer-title {
  color: var(--dark-text-primary);
  font-size: 1.5rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.footer-title::before {
  content: '🤖';
  font-size: 1.25rem;
}

.footer-description {
  color: var(--dark-text-secondary);
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.footer-stats {
  display: flex;
  gap: 1.5rem;
}

.stat-item {
  text-align: center;
}

.stat-number {
  display: block;
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--chipa-primary);
}

.stat-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  opacity: 0.8;
}

.footer-section-title {
  color: var(--dark-text-primary);
  font-size: 1rem;
  margin-bottom: 1rem;
  font-weight: 600;
}

.footer-links {
  list-style: none;
  margin: 0;
  padding: 0;
}

.footer-links li {
  margin-bottom: 0.5rem;
}

.footer-links a {
  color: var(--dark-text-secondary);
  text-decoration: none;
  transition: var(--transition-fast);
  font-size: 0.875rem;
}

.footer-links a:hover {
  color: var(--chipa-primary);
}

/* Newsletter section */
.footer-newsletter {
  background: linear-gradient(135deg, var(--chipa-primary), var(--chipa-secondary));
  color: white;
  padding: 2rem;
  border-radius: 12px;
  margin-bottom: 2rem;
  text-align: center;
}

.newsletter-content h3 {
  color: white;
  margin-bottom: 0.5rem;
}

.newsletter-content p {
  opacity: 0.9;
  margin-bottom: 1.5rem;
}

.newsletter-form {
  display: flex;
  gap: 0.5rem;
  max-width: 400px;
  margin: 0 auto 1rem;
}

.newsletter-input {
  flex: 1;
  padding: 0.75rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
}

.newsletter-input:focus {
  outline: 2px solid rgba(255, 255, 255, 0.3);
}

.newsletter-btn {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 0.75rem 1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: var(--transition-fast);
  white-space: nowrap;
}

.newsletter-btn:hover {
  background: rgba(255, 255, 255, 0.3);
}

.newsletter-disclaimer {
  font-size: 0.75rem;
  opacity: 0.8;
  margin: 0;
}

.newsletter-disclaimer a {
  color: white;
  text-decoration: underline;
}

/* Social links */
.footer-social {
  text-align: center;
  margin-bottom: 2rem;
}

.footer-social h4 {
  color: var(--dark-text-primary);
  margin-bottom: 1rem;
}

.social-links {
  display: flex;
  justify-content: center;
  gap: 1rem;
}

.social-links a {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: var(--chipa-primary);
  color: white;
  border-radius: 50%;
  text-decoration: none;
  transition: var(--transition-fast);
}

.social-links a:hover {
  background: var(--chipa-secondary);
  transform: translateY(-2px);
}

/* Bottom footer */
.footer-bottom {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding: 1.5rem 0;
}

.footer-bottom-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.footer-left p {
  margin: 0;
  font-size: 0.875rem;
  color: var(--dark-text-secondary);
}

.footer-note {
  opacity: 0.7;
  font-size: 0.75rem !important;
  margin-top: 0.25rem !important;
}

.footer-links-inline {
  display: flex;
  gap: 1.5rem;
  margin-bottom: 0.5rem;
}

.footer-links-inline a {
  color: var(--dark-text-secondary);
  text-decoration: none;
  font-size: 0.75rem;
  transition: var(--transition-fast);
}

.footer-links-inline a:hover {
  color: var(--chipa-primary);
}

.performance-indicator {
  font-size: 0.75rem;
  color: var(--dark-text-secondary);
  opacity: 0.7;
}

.performance-value {
  font-family: var(--font-family-mono);
  color: var(--chipa-primary);
}

/* Back to top button */
.back-to-top {
  position: fixed;
  bottom: 2rem;
  left: 2rem;
  width: 50px;
  height: 50px;
  background: var(--chipa-primary);
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-normal);
  box-shadow: var(--shadow-lg);
  z-index: 999;
}

.back-to-top.visible {
  opacity: 1;
  visibility: visible;
}

.back-to-top:hover {
  background: var(--chipa-secondary);
  transform: translateY(-2px);
}

/* Chipa link styling */
.chipa-link {
  color: var(--chipa-primary);
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition-fast);
}

.chipa-link:hover {
  color: var(--chipa-secondary);
  text-decoration: underline;
}

/* Mobile responsive */
@media (max-width: 968px) {
  .footer-sections {
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
  }
  
  .footer-section:first-child {
    grid-column: 1 / -1;
  }
}

@media (max-width: 640px) {
  .footer-sections {
    grid-template-columns: 1fr;
  }
  
  .footer-stats {
    justify-content: center;
  }
  
  .newsletter-form {
    flex-direction: column;
  }
  
  .social-links {
    flex-wrap: wrap;
  }
  
  .footer-bottom-content {
    flex-direction: column;
    gap: 1rem;
    text-align: center;
  }
  
  .footer-links-inline {
    justify-content: center;
  }
  
  .back-to-top {
    bottom: 1rem;
    left: 1rem;
    width: 44px;
    height: 44px;
  }
}
</style>

<script>
// Newsletter subscription
function subscribeNewsletter(event) {
  event.preventDefault();
  const email = event.target.querySelector('input[type="email"]').value;
  
  // In a real implementation, this would send to your backend
  console.log('Newsletter subscription:', email);
  
  // Send to analytics
  if (typeof gtag !== 'undefined') {
    gtag('event', 'newsletter_signup', {
      'email': email
    });
  }
  
  // Show success message
  const form = event.target;
  const originalHTML = form.innerHTML;
  
  form.innerHTML = `
    <div class="newsletter-success">
      <i class="fas fa-check-circle"></i>
      <span>Thank you for subscribing!</span>
    </div>
  `;
  
  // Reset form after 3 seconds
  setTimeout(() => {
    form.innerHTML = originalHTML;
  }, 3000);
}

// Back to top functionality
function scrollToTop() {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
}

// Show/hide back to top button
window.addEventListener('scroll', function() {
  const backToTop = document.getElementById('back-to-top');
  if (window.pageYOffset > 300) {
    backToTop.classList.add('visible');
  } else {
    backToTop.classList.remove('visible');
  }
});

// Performance monitoring
window.addEventListener('load', function() {
  setTimeout(() => {
    if ('performance' in window) {
      const perfData = performance.getEntriesByType('navigation')[0];
      const loadTime = Math.round(perfData.loadEventEnd - perfData.fetchStart);
      
      const loadTimeElement = document.getElementById('load-time');
      if (loadTimeElement) {
        loadTimeElement.textContent = loadTime + 'ms';
        
        // Color code based on performance
        if (loadTime < 1000) {
          loadTimeElement.style.color = 'var(--success-color)';
        } else if (loadTime < 3000) {
          loadTimeElement.style.color = 'var(--accent-color)';
        } else {
          loadTimeElement.style.color = 'var(--danger-color)';
        }
      }
    }
  }, 1000);
});
</script>


    <!-- JavaScript -->
    <script src="/AxiomTradeAPI-py/assets/js/main.js"></script>
</body>
</html>
